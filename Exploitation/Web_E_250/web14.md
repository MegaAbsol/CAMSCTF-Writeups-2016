#Web E - 250
  
	Ha. Ha. Ha.
  
[Web E](http://web.camsctf.com/14)

-------------

It seems that we can't brute force the password. However, at the bottom of `response.js` this time, we see a big lump of code, which when made prettier, looks like:

```javascript
function password(e) {
    if (e.length != 19) {
        return false
    }
    if (e.charAt(6) != e.charAt(12)) {
        return false
    }
    if (e.charCodeAt(10) != 95) {
        return false
    }
    if (e.charCodeAt(3) - e.charCodeAt(5) != (e.charCodeAt(17) - e.charCodeAt(11)) * 9) {
        return false
    }
    if (e.charCodeAt(5) + e.charCodeAt(11) + e.charCodeAt(17) != 293) {
        return false
    }
    if (e.charCodeAt(17) - e.charCodeAt(11) + e.charCodeAt(5) != 69) {
        return false
    }
    if (e.charCodeAt(3) != e.charCodeAt(18) - 15) {
        return false
    }
    var data = [];
    var data2 = [];
    for (i = 0; i < e.length; i = i + 2) {
        data.push(e.charCodeAt(i))
    }
    for (i = 1; i < e.length; i = i + 2) {
        data2.push(e.charCodeAt(i))
    }
    if (data[0] != data[8]) {
        return false
    }
    if (data2[4] != data[9]) {
        return false
    }
    if ((data[0] & data[3]) != (data[0] - Math.pow(2, 4))) {
        return false
    }
    if ((data[1] | data[2]) != data2[7]) {
        return false
    }
    if ((data[3] >> 1) != (data[0] << 1) / 2) {
        return false
    }
    if ((data[2] & data[3]) != data[6]) {
        return false
    }
    if ((e.charCodeAt(10) ^ data[2]) != 42 + 2) {
        return false
    }
    if (data[2] != data2[6]) {
        return false
    }
    if ((data[8] | 1) != (data[8] + 1)) {
        return false
    }
    if (String.fromCharCode(data2[6]).toUpperCase() != e.charAt(14)) {
        return false
    }
    if ((data2[6] >> 5) * 34 != data[1]) {
        return false
    }
    a
    if ((data[1] + data2[0]) / 2 != data[9]) {
        return false
    }
    if (data[9] % 10 !== 0) {
        return false
    }
    if (data[4] != data[1] / 2) {
        return false
    }
    return true
};
```

Ugh, reminds me of CSAW finals and z3. I did that by hand, and since I still don't know z3 I'll do this one by hand too.

We immediately see that the 10th character has a charcode of 95 ('_') and that it is 19 characters long. It then does some checks with characters.

The next part involves `data` and `data2`. `data` is every other character of the password, starting with the first one, and `data2` is every other character starting with the second. So we have:

```
e    : **********_********
data : *****_****
data2: *********
```

We also see:

```javascript
if ((e.charCodeAt(10) ^ data[2]) != 42 + 2) {
    return false
}
```
so 95^data[2] = 44, so data[2] = 115 (s). But data[2] is also e[4]. From

```javascript
if (data[2] != data2[6]) {
    return false
}
```

we know that data2[6] = e[13] = 115 as well. So now we have:

```
e    : ****s*****_**s*****
data : **s**_****
data2: ******s**
```

Next:
```javascript
if ((data2[6] >> 5) * 34 != data[1]) {
    return false
}
```
So data[1] = 3*34 = 102 (f) = e[2]. And from 

```javascript
if ((data[1] | data[2]) != data2[7]) {
    return false
}
```
we get data2[7] = 119 (w) = e[15].

Progress:
```
e    : **f*s*****_**s*w***
data : *fs**_****
data2: ******sw*
```
```javascript
if (data[4] != data[1] / 2) {
    return false
}
```
so data[4] is 51, and
```
if (String.fromCharCode(data2[6]).toUpperCase() != e.charAt(14)) {
    return false
}
so e[14] = 'S' (and so is data[7]).

```
e    : **f*s***3*_**sSw***
data : *fs*3_*S**
data2: ******sw*
```

We can use
```javascript
if ((data[0] & data[3]) != (data[0] - Math.pow(2, 4))) {
    return false
}
if ((data[3] >> 1) != (data[0] << 1) / 2) {
    return false
}
if ((data[2] & data[3]) != data[6]) {
    return false
}
```
to solve for data[3] and data[0] because (data[0] << 1) / 2 = data[0], so data[3] = 97, data[0] = 48, and data[6] = 97. Also, data[0] = data[8].
Now:
```
e    : 0*f*s*a*3*_*asSw0**
data : 0fsa3_aS0*
data2: ******sw*
```
Next:
```javascript
if ((data[1] + data2[0]) / 2 != data[9]) {
    return false
}
if (data[9] % 10 !== 0) {
    return false
}
```
From the second one, data[9] is either 70, 80, 90, 100, 110, or 120. Thus data2[0] can only be 38, 58, 78, 98, 118, or 138. But only 78, 98, and 118 are letters, so data[9] is either 90, 100, or 110. Now
```javascript
if ((((data2[0] % 7) + 3) | data[8]) != data[4]) {
    return false
}
```
Only 98 works, so data2[0] = 98, and data[9] = 100. data2[4] = data[9] as well.
```
e    : 0bf*s*a*3d_*asSw0*d
data : 0fsa3_aS0d
data2: b***d*sw*
```

At this point, we can pretty much guess the password (there was more but this writeup is long enough as it is):

`0bfUsCat3d_pasSw0rd`

We plug this in to get the flag.

Flag: `{why_lujing_why_w0uld_you_do_this}`

Note: alternatively you could just get z3.